<div class="hidden">
<meta property="og:image" content="http://the-dining-philosophers.github.io/code-weekend/assets/img/logo.png"><link rel="shortcut icon" href="assets/images/favicon.png"><link rel="stylesheet" href="assets/css/global.css"><link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"><link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,300,600,700' type='text/css'>
</div>
<img class="full-img" src="assets/img/logo.png">
<div class="nav-items">
<div id="setup-menu" class="nav-item">
Intro to Web
</div>
<div id="node-menu" class="nav-item">
NodeJS
</div>
<div id="apis-menu" class="nav-item">
APIs
</div>
<div id="dbs-menu" class="nav-item">
Databases
</div>
</div>
<h1 id="code-weekend">Code Weekend</h1>
<h2 id="building-your-first-webapp">Building your first webapp</h2>
<p><a href="http://goo.gl/forms/hXb2IVeMM9">Sign up here!</a></p>
<p>Code Weekend is scheduled for <em>January 24th and 25th, 2015</em> and will comprise of four workshops to help participants build their very own webapp. Participants are expected to have very minimal coding experience as we will be carefully explaining everything we do as we go. This should be extremely helpful to first time hackers (a fun term we use for people that build things!) especially with <a href="http://pennapps.com" title="PennApps Winter 2015">PennApps</a> scheduled for the weekend before. If you haven't already, check it out - it's a great way to jump in the deep end and expose yourself to the incredible world of building things (and actually they're doing great stuff for first-time hackers as well).</p>
<blockquote>
<p>These workshops have been organized by the Dining Philosophers, PennApps and many talented individuals. Student mentors will be around to help participants as we go through these highly interactive, live-coding-based workshops.</p>
</blockquote>
<p>If you already have some coding experience, then feel free to skip the first session. Here's what we expect you to know and have installed before you jump into the second session:</p>
<ul>
<li>The basics of how the web works.</li>
<li>HTML/CSS/Javascript to the extent that you can build a simple static webpage.</li>
<li>Know how to use Terminal/Command Prompt to move folders, change directories, and create files.</li>
</ul>
<blockquote>
<p>You can find the workshops from the last Code Weekend (September 6th and 7th, 2014) <a href="past/fall14/index.html">here</a>. However, this is really just an updated version of the same workshops so you should probably stay on this page.</p>
</blockquote>
<h1 id="intro-to-web-development">Intro to Web Development <a id="setup-section"></a></h1>
<h2 id="web-pages-and-the-basics-of-development">Web Pages and the basics of development</h2>
<p>Welcome to your first coding experience!</p>
<p>We'll be going over quite a few things in this opening workshop:</p>
<ul>
<li><a href="#an-introduction-to-the-life-of-a-developer">How to search effectively using Google + Using Stack Overflow</a></li>
<li><a href="#an-introduction-to-the-web">How the internet works and why web development is so different from, say, Java</a></li>
<li><a href="#simple-html-and-css">Basic HTML and CSS and how webpages are structured</a></li>
<li><a href="#javascript-finally">Javascript, JSON and how to make things more fun</a></li>
<li><a href="#what-is-terminalcommand-prompt">What is Terminal/Command Prompt</a></li>
<li><a href="#making-a-personal-landing-page">Build your own Personal landing page</a></li>
</ul>
<p>This shouldn't take too long though, and we're going to go ahead and leave the rest of the time for you to turn a basic static webpage that we'll give you into your own personal landing page.</p>
<p>So let's get started!</p>
<h3 id="an-introduction-to-the-life-of-a-developer">An Introduction to (the) Life (of a Developer)</h3>
<p>When coding, you'll run into tons of small problems and errors that you don't initially know how to solve. <strong><em>This is completely normal.</em></strong> In order to teach solutions to every problem that you could hypothetically run into, we'd need a textbook taller than the Empire State building.</p>
<p>Thankfully, we all have a resource with more information than that constantly at our fingertips - teh interwebz. You've probably searched for things using Google before, but most coding problems can actually be solved by effective Googling of your issue. Here are some tips for finding the answers to all your problems on the Internet:</p>
<ul>
<li>Be descriptive. If you're searching for what's causing an error then you can try just searching for the entire error message, or try describing what happened. For example, &quot;Homebrew does not install through terminal on OSX Yosemite&quot; is a better search query than &quot;homebrew not working&quot;, though the best search query is often some combination of plain text and the actual error message. Often error codes make great search queries, as long as they are contextualized (i.e. with the name of the language/environment).</li>
<li>Along that vein, use as many specific words as possible. You can use complete sentences if you'd like, but normally four or five very descriptive nouns/verbs is ideal, and you won't throw Google off-track by searching for unnecessary things. For example, you try to put a banner at the top of a web page, but there's a weird white border around the entire page. Googling &quot;there's a weird white border around the entire page&quot; isn't helpful. Always start with the name of the language you think is suspect if you can (in this case, it's CSS, since all style things on the page are controlled by CSS). Then, describe the problem with just a few words. Here, I used &quot;CSS no page border&quot;. The first result was really helpful, and ended up solving my problem.</li>
</ul>
<p>These resources are also awesome:</p>
<ul>
<li><a href="http://stackoverflow.com">Stack Overflow</a> is the best. Search results that link here are often the most helpful, and you can almost always find someone who's had the same problem as you on here. You should mostly refrain from posting questions to Stack Overflow since odds are your question has already been answered there somewhere.</li>
<li>If you're looking for syntax, or lists of inbuilt functions, then look for the Official Documentation for the language in question. <a href="http://www.w3schools.com">W3C Schools</a> is great for HTML, CSS, and Javascript.</li>
<li><a href="https://www.bento.io">Bentobox</a> is a great all-in-one resource to learn to code for a huge number of technologies.</li>
<li><a href="http://www.codecademy.com/learn">Code Academy</a> has some great tutorials. The lessons for each language can get tedious, but the tutorials where you build actual things are pretty great. If you're looking for a good introduction to HTML/CSS, <a href="https://dash.generalassemb.ly/">General Assembly's Dash</a> is probably the best place to start.</li>
</ul>
<h3 id="an-introduction-to-the-web">An Introduction to the web</h3>
<p>There's pretty much three things happening every time you open a website:</p>
<ul>
<li>Your browser looks up an address (say google.com) and follows it back to its home - the server which actually runs the website. This server is basically just a computer, albeit a huge, immensely powerful computer possibly comprising acres of computer hardware connected together.</li>
<li>This server is what we call the <em>backend</em>. This server now processes your request - it could be a request to view the website or something more complicated like an attempt to log in - and sends a response back to your computer. This server will often be programmed in languages such as Python, Ruby on Rails, even Java (but not as much these days). Node.JS is a framework that lets us use Javascript on the backend as well as the frontend.</li>
<li>Your computer now reads this response and converts it into the webpage you actually see on your computer. This last bit of conversion is what we call the <em>frontend</em> doing its work.</li>
</ul>
<div class="figure">
<img src="assets/img/server-browser.png" alt="Server- Browser" />
<p class="caption">Server- Browser</p>
</div>
<p>So basically, any work done on a server has been programmed into the backend, while anything done inside your browser has been programmed into the frontend. These are basically the two main components of any website.</p>
<p>You'll see later on that requests aren't just made of the server when we first open the website; it's often faster to make smaller requests first, load the important parts of a webpage and then request additional bits of information when they're needed (think Facebook's Newsfeed). It's also used when we do things like log in to a website. This is one of the reasons why Javascript is so useful as a frontend programming language, as it allows us to do these kinds of things very easily and update the webpage immediately without having to refresh the page.</p>
<div class="figure">
<img src="http://www.product-reviews.net/wp-content/uploads/facebook-not-working.jpg" alt="Facebook Loading using Javascript" />
<p class="caption">Facebook Loading using Javascript</p>
</div>
<h3 id="simple-html-and-css">Simple HTML and CSS</h3>
<p>HTML (Hypertext Markup Language) is like the backbone of any webpage. It's where we add in all the information - what the webpage actually displays as well as information about the page itself such as its title.</p>
<div class="figure">
<img src="http://static.webplatform.org/w/public/6/6e/article4.gif" alt="With and without CSS" />
<p class="caption">With and without CSS</p>
</div>
<p>CSS dresses up this information. Most (but really all) webpages link to a CSS file that stores information on how a browser should display the information it recieves in the HTML. While it is possible to add CSS code into the HTML document, it is never done as it makes it nearly impossible to keep track of code and also slows down the page.</p>
<p>Javascript is the fun part. It does dynamic things with your webpage, updates content on the fly and can animate just about anything. We'll talk about this later.</p>
<div class="figure">
<img src="http://splurd.com/comics/images/1337794967.jpg" alt="Javascript meme" />
<p class="caption">Javascript meme</p>
</div>
<p>Every webpage is built in the HTML DOM (Document Object Model). This means that every element in the HTML is an element (or a Node, the mathematical kind - not to be confused with Node.JS). So we could call this paragraph an element in the DOM; the same is true of any of the images and pretty much everything else here.</p>
<p>Let's start with HTML (Hypertext Markup Language).</p>
<div class="figure">
<img src="http://38.media.tumblr.com/tumblr_m4fl5qPjdU1rw659vo1_400.png" alt="HTML meme" />
<p class="caption">HTML meme</p>
</div>
<p>HyperText is text that will hyperlink you to other text. That's it. Think <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">links</a>.</p>
<p>It is called a Markup Language because HTML is not written as plain text. It is marked up into the form of HTML elements called 'tags.' Tags are denoted by <code>&lt;</code> followed by <code>&gt;</code>. Below is the most basic HTML document we can create (except for the comments that we've added in to make things clearer).</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- This, is a comment that does not affect any of the code we write. We can use this to leave notes in the code for our future selves, or for others reading our code. This is also the most basic HTML document you can create. --&gt;</span>
<span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span>
<span class="kw">&lt;html&gt;</span>
    <span class="kw">&lt;head&gt;</span>
        <span class="kw">&lt;title&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;/head&gt;</span>
    <span class="kw">&lt;body&gt;</span>
        <span class="kw">&lt;p&gt;</span>This is a basic HTML webpage.<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<p><code>&lt;!DOCTYPE html&gt; &lt;html&gt;</code> is how you should start any HTML file. For every HTML tag that we open, there must be one that closes it. This way we can easily tell what information is contatined in what tag, and it allows for easy nesting. The obvious drawback is that this is highly verbose. For example, <code>&lt;html&gt;</code> must eventually be closed by <code>&lt;/html&gt;</code>.</p>
<p>Usually though, we'll include more information about the page in the <code>&lt;head&gt;</code> tag like this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;utf-8&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> content=</span><span class="st">&quot;Code Weekend Sample Page&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;title&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;main.css&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/head&gt;</span></code></pre>
<p>So now we've specified the character set that the page uses - this is just to make sure the browser doesn't think that the page is in a language other than english. Then there's a description followed by the actual page title (this is what you see in the title bar of your browser). Finally there's a tag where we've linked this HTML file to a CSS document (the <code>href</code> component is how we tell the browser where to look for this file - it can be a path or a web address). This is how we add external CSS files to a webpage.</p>
<p>Now let's get to the fun part - the <code>&lt;body&gt;</code> tag. This is where all the actual stuff that shows up on your webpage goes. Let's try adding some information in.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;body&gt;</span>
    <span class="kw">&lt;h1&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/h1&gt;</span>
    <span class="kw">&lt;h2&gt;</span>Here&#39;s a smaller heading. We can go all the way down to H6<span class="kw">&lt;/h2&gt;</span>
    <span class="co">&lt;!-- Here&#39;s a comment that will not show up on the actual page --&gt;</span>
    <span class="kw">&lt;p&gt;</span>
        Here&#39;s a paragraph of text. You can fill in whatever you feel like in here and just end this tag to fininsh the paragraph.
    <span class="kw">&lt;/p&gt;</span>
<span class="kw">&lt;/body&gt;</span></code></pre>
<p>Let's look at this whole document now.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- This, is a comment that does not affect any of the code we write. We can use this to leave notes in the code for our future selves, or for others reading our code. This is a slightly more compelte HTML document, but still doesn&#39;t have any information about styles. --&gt;</span>
<span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span>
<span class="kw">&lt;html&gt;</span>
    <span class="kw">&lt;head&gt;</span>
        <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;utf-8&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> content=</span><span class="st">&quot;Code Weekend Sample Page&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;title&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/title&gt;</span>
        <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;main.css&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;/head&gt;</span>
    <span class="kw">&lt;body&gt;</span>
        <span class="kw">&lt;h1&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/h1&gt;</span>
        <span class="kw">&lt;h2&gt;</span>Here&#39;s a smaller heading. We can go all the way down to H6<span class="kw">&lt;/h2&gt;</span>
        <span class="co">&lt;!-- Here&#39;s a comment that will not show up on the actual page --&gt;</span>
        <span class="kw">&lt;p&gt;</span>
            Here&#39;s a paragraph of text. You can fill in whatever you feel like in here and just end this tag to fininsh the paragraph.
        <span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>Here are some more important HTML tags:</p>
<ul>
<li><code>&lt;a href=&quot;link here&quot;&gt;text for the link&lt;/a&gt;</code> - used to create links</li>
<li><code>&lt;img src=&quot;path/link to image&quot; alt=&quot;text to show if image doesn't load&quot; /&gt;</code> - used to add images</li>
<li><code>&lt;em&gt;text here&lt;/em&gt;</code> - used for italicising text</li>
<li><code>&lt;strong&gt;text here&lt;/strong&gt;</code> - used to bold text</li>
<li><code>&lt;ul&gt;</code> and <code>&lt;ol&gt;</code> - used to start Unordered and Ordered Lists
<ul>
<li><code>&lt;li&gt;Item here&lt;/li&gt;</code> - used to denote each item in a list</li>
</ul></li>
<li><code>&lt;script&gt; Code in here &lt;/script&gt;</code> - used to add non-HTML code such as Javascript to a page. We can (and should) instead add an <code>src</code> attribute to the <code>&lt;script&gt;</code> tag and link to an external Javascript file to keep our ccode clean and maintainable.</li>
<li><code>&lt;div&gt;</code> - used to denote different divisions within your HTML body. Possibly one of the most useful tags when it comes to layout and styling in CSS.</li>
</ul>
<h4 id="umm-what-about-css">Umm, what about CSS?</h4>
<p>Right. So before we can decide how things should look, we actually need a way to find these things. That HTML document we said was almost complete, well, it was almost complete. The last thing we need to add in are identifiers, and these fall into two categories:</p>
<ul>
<li>IDs: These are unique to an individual HTML element. Once I give an ID to an element, it cannot be used again. Every element can be assigned an ID. For example, <code>&lt;p id=&quot;introduction&quot;&gt;</code>.</li>
<li>Classes: These are reusable names that we give to ranges of elements. This allows us to do thigns like apply the same style (say, a font) to multiple elements rather than having to rewrtie the same thing over and over. For example, we can create multiple paragraphs with the same class <code>&lt;p class=&quot;red-text&quot;&gt; This text is theoretically red.&lt;/p&gt; &lt;p class=&quot;red-text&quot;&gt; This text is also presumably red. &lt;/p&gt;</code>.</li>
</ul>
<p>Now we have a way to decide on styles. Let's look at that HTML document again:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- This, is a comment that does not affect any of the code we write. We can use this to leave notes in the code for our future selves, or for others reading our code. This is a slightly more compelte HTML document, but still doesn&#39;t have any information about styles. It however does use identifiers, so we&#39;re one step closer to styling. --&gt;</span>
<span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span>
<span class="kw">&lt;html&gt;</span>
    <span class="kw">&lt;head&gt;</span>
        <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;utf-8&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> content=</span><span class="st">&quot;Code Weekend Sample Page&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;title&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/title&gt;</span>
        <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;main.css&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;/head&gt;</span>
    <span class="kw">&lt;body&gt;</span>
        <span class="kw">&lt;h1&gt;</span>Code Weekend Sample Page<span class="kw">&lt;/h1&gt;</span>
        <span class="kw">&lt;h2&gt;</span>Here&#39;s a smaller heading. We can go all the way down to H6<span class="kw">&lt;/h2&gt;</span>
        <span class="co">&lt;!-- Here&#39;s a comment that will not show up on the actual page --&gt;</span>
        <span class="kw">&lt;p</span><span class="ot"> class=</span><span class="st">&quot;red-text&quot;</span><span class="ot"> id=</span><span class="st">&quot;intro-para&quot;</span><span class="kw">&gt;</span>
            Here&#39;s a paragraph of text. You can fill in whatever you feel like in here and just end this tag to fininsh the paragraph.
        <span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>We can also just change the style for an entire kind of element. So we could just change how all <code>&lt;h1&gt;</code> tags look. Let's take a look at what CSS looks like:</p>
<pre class="sourceCode css"><code class="sourceCode css">body <span class="kw">{</span>
    <span class="kw">padding:</span> <span class="dt">50px</span> <span class="dt">100px</span><span class="kw">;</span>
<span class="kw">}</span>
h1 <span class="kw">{</span>
    <span class="kw">font-size:</span> <span class="dt">40px</span><span class="kw">;</span>
    <span class="kw">font-weight:</span> <span class="dt">lighter</span><span class="kw">;</span>
    <span class="kw">color:</span> <span class="dt">blue</span><span class="kw">;</span>
<span class="kw">}</span>
<span class="fl">.red-text</span> <span class="kw">{</span>
    <span class="kw">color:</span> <span class="dt">red</span><span class="kw">;</span>
<span class="kw">}</span>
<span class="fl">#intro-para</span> <span class="kw">{</span>
    <span class="kw">border:</span> <span class="dt">2px</span> <span class="dt">solid</span> <span class="dt">black</span><span class="kw">;</span>
<span class="kw">}</span></code></pre>
<p>As you can see, there are small differences in syntax depending on the selector (whether you're changing all instances of an element, instances of a class, or just a single element by ID) but it's mostly quite simple.</p>
<p>You should look through the resources at the top of this section for more information on HTML tags and CSS attributes, but the best thing to do is to Google things you're looking to do and look for the <a href="http://www.w3schools.com">W3C Schools</a> or <a href="http://stackoverflow.com">Stack Overflow</a> results.</p>
<div class="figure">
<img src="http://i.stack.imgur.com/XdONP.png" alt="Stack Overflow" />
<p class="caption">Stack Overflow</p>
</div>
<p>You can download the <a href="assets/files/sample.html">HTML</a> and <a href="assets/files/main.css">CSS</a> files we looked at here by following these links.</p>
<p>A great way to play around with CSS styles is to right-click on this page in Chrome of Firefox, Inspect Element, and try changing the CSS styles on the right hand side of the Developer Tools window after selecting the HTML element you want to edit.</p>
<div class="figure">
<img src="https://developer.chrome.com/devtools/docs/css-preprocessors-files/sass-debugging.png" alt="Chrome dev tools" />
<p class="caption">Chrome dev tools</p>
</div>
<h3 id="javascript-finally">Javascript, finally!</h3>
<p>Javascript is a scripting language and has very little to do with Java other than vaguely resembling it in syntax. By scripting language we mean that there are no Classes, Interfaces, Main Methods or any of the regular Object-Oriented Programming that we're (maybe) used to. You just write code in a file, link to it in your HTML and it exectutes.</p>
<div class="figure">
<img src="http://www.memegenerator.eu/media/created/iyflyp.jpg" alt="Javascript meme" />
<p class="caption">Javascript meme</p>
</div>
<p>Javascript is a very easy language to pick up. There are no types, Javascript just guesses (mostly well) what you want. This means that writing <code>var x = 5</code> will create a variable named <code>x</code> of the type <code>Integer</code> with the value of <code>5</code>. Writing <code>var x = &quot;5&quot;</code> would create a <code>String</code> named <code>x</code> with the string <code>5</code> as its value.</p>
<p>The most common types we will use are Strings (just text, such as &quot;This is some text&quot;), Integers (just plain old numbers, like 5, 6, 42, or 314596 - no decimal points though), Doubles (decimal points are now allowed, so 3.14 is good to go) and Booleans (True or False). There are a whole bunch of functions and operators built into Javascript that we can use on these data-types. You should search for them as and when you need to do something that you think is fairly common (you'll be surprised by how common almost everything you wanna do is).</p>
<p>Here's some sample Javascript code:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> myVariable = <span class="st">&quot;January 16th&quot;</span>;
<span class="fu">alert</span> (<span class="st">&quot;PennApps started on &quot;</span> + myVariable);</code></pre>
<p>This creates an alert that says &quot;PennApps starts on January 16th&quot;. There was absolutely no reason to use a variable here other than to show how we can use it. Here's a function in Javascript that squares a number:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="fu">square</span> (number) {
    <span class="kw">return</span> number * number;
}

<span class="co">// This is a single line comment that does not need to be closed.</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="fu">square</span> (<span class="dv">5</span>)); <span class="co">// This prints the result to the javascript console in your browser&#39;s (Chrome or Firefox) developer tools.</span>

<span class="co">/* This is a multi-line comment</span>
<span class="co">   that only ends when we do this */</span>

<span class="co">// We can also write the above function as the following:</span>
<span class="kw">var</span> square = <span class="kw">function</span> (number) {
    <span class="kw">return</span> number * number;
}

<span class="co">// Here&#39;s an anonymous function that calculates the square of 5:</span>
(<span class="kw">function</span> (number) {
    <span class="kw">return</span> number*number;
}) (<span class="dv">5</span>);

<span class="co">// In that case, we were executing the anonymous function immediately, but we don&#39;t have to always do that:</span>
<span class="kw">function</span> <span class="fu">idPlusString</span> (number) {
    <span class="kw">var</span> cube = number * number * number;
    <span class="kw">return</span> <span class="kw">function</span> (name) {
        <span class="kw">return</span> <span class="st">&quot;Hi &quot;</span>+ name + <span class="st">&quot;. &quot;</span> + <span class="st">&quot;Your ID is &quot;</span> + cube + <span class="st">&quot;.&quot;</span>;
    }
}
<span class="co">// This returns a function that you can add a string to. If you don&#39;t understand this last function, it&#39;s okay.</span></code></pre>
<p>Javascript mainly works on Objects and Arrays to store and access data.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// Here&#39;s an Object that conatins an array</span>
<span class="kw">var</span> myDetails = {
    <span class="st">&#39;name&#39;</span> : <span class="st">&quot;Mark Gates&quot;</span>,
    <span class="st">&#39;age&#39;</span> : <span class="dv">24</span>,
    <span class="st">&#39;interests&#39;</span>: [<span class="st">&#39;Figure Skating&#39;</span>, <span class="st">&#39;Javascript&#39;</span>, <span class="st">&#39;Tennis&#39;</span>, <span class="st">&#39;EDM&#39;</span>]
}

<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">myDetails</span>.<span class="fu">name</span>); <span class="co">// prints the name property of the object, ie, &#39;Mark Gates&#39;</span>

<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">myDetails</span>.<span class="fu">interests</span>[<span class="dv">1</span>]); <span class="co">// prints &#39;Javascript&#39; to the console</span></code></pre>
<p>Objects are essentially key-value pairs. We can access to values easily using the notation <code>object.key</code>.</p>
<p>If you haven't noticed yet, we end almost every line (or more specifically, every command) with a semicolon. It's okay if you end every line with one, it's better to err on the side of more rather than less, but you can get away with leaving off the semicolons after function definitions and pretty much everything that ends in curly braces (<code>}</code>).</p>
<p><em>JSON (Javascript Object Notation)</em> is the data format of the internet. This is what is used to send data that is not HTML/CSS/JS across the internet. That could range from search results to login sessions. Another commonly used format is XML, but that is slowly being replaced everywhere by JSON. JSON is very simple to understand because every JSON file is simply one Javascript Object. It uses key-value pairs and Arrays liberally to store information. Let's look at an example of a JSON file:</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
    <span class="dt">&quot;employees&quot;</span><span class="fu">:</span><span class="ot">[</span>
        <span class="fu">{</span>
            <span class="dt">&quot;firstName&quot;</span><span class="fu">:</span><span class="st">&quot;John&quot;</span><span class="fu">,</span> 
            <span class="dt">&quot;lastName&quot;</span><span class="fu">:</span><span class="st">&quot;Doe&quot;</span>
        <span class="fu">}</span><span class="ot">,</span> 
        <span class="fu">{</span>
            <span class="dt">&quot;firstName&quot;</span><span class="fu">:</span><span class="st">&quot;Anna&quot;</span><span class="fu">,</span> 
            <span class="dt">&quot;lastName&quot;</span><span class="fu">:</span><span class="st">&quot;Smith&quot;</span>
        <span class="fu">}</span><span class="ot">,</span>
        <span class="fu">{</span>
            <span class="dt">&quot;firstName&quot;</span><span class="fu">:</span><span class="st">&quot;Peter&quot;</span><span class="fu">,</span> 
            <span class="dt">&quot;lastName&quot;</span><span class="fu">:</span><span class="st">&quot;Jones&quot;</span>
        <span class="fu">}</span>
        <span class="ot">]</span><span class="fu">,</span>
    <span class="dt">&quot;company&quot;</span> <span class="fu">:</span> <span class="st">&quot;ABC Holdings&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;lastUpdated&quot;</span> <span class="fu">:</span> <span class="st">&quot;September 6th&quot;</span>
<span class="fu">}</span></code></pre>
<p>It's exactly like a Javascript Object, and that's because that's exactly what it is. Just for kicks, let's compare this to XML:</p>
<pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;employees&gt;</span>
    <span class="kw">&lt;employee&gt;</span>
        <span class="kw">&lt;firstName&gt;</span>John<span class="kw">&lt;/firstName&gt;</span> 
        <span class="kw">&lt;lastName&gt;</span>Doe<span class="kw">&lt;/lastName&gt;</span>
    <span class="kw">&lt;/employee&gt;</span>
    <span class="kw">&lt;employee&gt;</span>
        <span class="kw">&lt;firstName&gt;</span>Anna<span class="kw">&lt;/firstName&gt;</span> 
        <span class="kw">&lt;lastName&gt;</span>Smith<span class="kw">&lt;/lastName&gt;</span>
    <span class="kw">&lt;/employee&gt;</span>
    <span class="kw">&lt;employee&gt;</span>
        <span class="kw">&lt;firstName&gt;</span>Peter<span class="kw">&lt;/firstName&gt;</span> 
        <span class="kw">&lt;lastName&gt;</span>Jones<span class="kw">&lt;/lastName&gt;</span>
    <span class="kw">&lt;/employee&gt;</span>
<span class="kw">&lt;/employees&gt;</span>
<span class="kw">&lt;company&gt;</span>ABC Holdings<span class="kw">&lt;/company&gt;</span>
<span class="kw">&lt;lastUpdated&gt;</span>September 6th<span class="kw">&lt;/lastUpdated&gt;</span></code></pre>
<p>So much better isn't it! JSON is way more readable and saves you the trouble of having to close every tag you open. Now imagine this on the scale of thousands of search results. JSON makes your life much easier, and websites much faster.</p>
<h3 id="what-is-terminalcommand-prompt">What is Terminal/Command Prompt?</h3>
<div class="figure">
<img src="assets/img/terminal.png" alt="Terminal" />
<p class="caption">Terminal</p>
</div>
<p>Terminal (or Command Prompt on Windows) is basically a way for us to access the Command Line. This gives us access to a wonderful variety of things that we can do. We will be spending a good amount of time this weekend in here, so let's take some time to get used to it.</p>
<p>Once you fire up Terminal or Command Prompt (on Windows, you'll later need to run cmd.exe by right clicking on the shortcut and clicking Run as Administrator, you'll know it's running as Admin if your path ends in <code>../system32</code>), here's how you get around:</p>
<ul>
<li><code>ls</code> (<code>DIR</code> on Windows) lists all the files in the current folder</li>
<li><code>cd</code> allows you to change directory. So <code>cd Documents</code> will move into the folder Documents, if there is such a folder in the current directory. You can check this by using <code>ls</code> (<code>DIR</code> on windows). To move up a directory, say back to where you were before you went into Documents, type in <code>cd ../</code>.</li>
<li><code>mkdir</code> allows you to make a folder in the current directory. So <code>mkdir New</code> makes a folder named 'New'.</li>
<li><code>mv</code> (<code>move</code> on windows) will let you move files and folders. In Terminal you can do <code>mv ~/Desktop/MyFile.rtf /Volumes/Backup/MyFolder</code> to move MyFile.rtf. On Windows <code>move c:\windows\temp\*.* c:\temp</code> will move everything from <code>C:\windows\temp</code> to <code>C:\temp</code>. <code>*</code> works as a wildcard operator here.</li>
</ul>
<p>Once you've installed Node.JS, you'll also be able to enter commands like <code>npm install express</code> that will use Node Package manager to install plugins such as Express. You'll aso be able to start up MongoDB from here using <code>mongod</code>.</p>
<h3 id="lets-start-doing-stuff">Let's start doing stuff!</h3>
<p>Whoohoo! We've made it this far, and it's finally time to start doing stuff!</p>
<h4 id="sublime-text-2">Sublime Text 2</h4>
<p>We've got to install a whole buch of stuff over the next few workshops. Let's start simple, go and download <a href="http://www.sublimetext.com/2">Sublime Text 2</a>. It's the best text editor in existence (yes, that's arguable) and this is where we're gonna be doing all our work. If you have a different favorite text editor, feel free to use it.</p>
<p>NOTE: Sometimes, when you save your work, a window will pop up asking you to buy Sublime. Just ignore this and hit &quot;Cancel&quot; and you can use it forever, or buy it and support a fellow developer!</p>
<h4 id="making-a-personal-landing-page">Making a Personal Landing Page</h4>
<p>Well done! You've got everything you need installed. Now let's test what you've learned in this workshop. Here's an <a href="assets/files/sample.html">HTML</a> and a <a href="assets/files/main.css">CSS</a> file. Try and use this as a base to create your own personal landing page. The adventurous ones among you can even try and create a compelte static website, you know enough that you can just Google anything further. Take a look at some of our organizers websites for inspiration (<a href="http://pvrnav.com">Pranav</a>, <a href="http://lewisjellis.com">Lewis</a>, <a href="http://bclay.github.io/homepage/">Brynn</a>, <a href="http://smuralidhar.com">Sudarshan</a>) or browse around the internet to see nice design (like <a href="http://medium.com">Medium</a>).</p>
<h4 id="files">Files</h4>
<p>You can download the <a href="assets/files/sample.html">HTML</a> and <a href="assets/files/main.css">CSS</a> files we looked at here by following these links. Use these as starting points for building your personal landing pages.</p>
<h1 id="intro-to-javascript-and-nodejs">Intro to Javascript and NodeJS <a id="node-section"></a></h1>
<h2 id="the-most-powerful-web-development-tools-ever">The most powerful web development tools ever</h2>
<p>Stuff to be covered:</p>
<ul>
<li>Installing Node</li>
<li>Basics of Node.js and Node package manager</li>
<li>The Express framework</li>
<li>Templates, sessions, and middlewares</li>
<li>Simple form processing</li>
</ul>
<h4 id="installing-nodejs">Installing NodeJS</h4>
<p>Now that you've got that installed, let's move on to some slightly more complicated stuff. Let's start with Node.JS.</p>
<p>Node.js is a commonly used web framework for building applications with Javascript. You need to run Node from command line. Instructions for different operating systems are below.</p>
<p><em>Mac</em></p>
<p>The easiest way to install Node is through Homebrew, a package manager for OSX. Sometimes it's already installed on your computer, and sometimes you need to install it. Bring up a terminal window and type in <code>brew install node</code>. When it finishes, it might show you a few commands you need to run in Terminal. Run those commands and you're all set! If that command instead spit out something about not knowing what <code>brew</code> is, read on.</p>
<p>So, you don't have homebrew. Let's try and install Homebrew, type this into Terminal: <code>ruby -e &quot;$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)&quot;</code></p>
<p>If Homebrew installed succesfully, then go ahead and try <code>brew install node</code>. If you run into any more errors here, try Googling the error text and looking for solutions. If that still doesn't work, look around for a mentor to help.</p>
<p>If Homebrew is causing too many problems then just try the installer <a href="http://nodejs.org/download/">here</a>. You can also install NodeJS using Fink (<code>fink install nodejs</code>) or MacPorts(<code>port install nodejs</code>).</p>
<p><em>Windows</em></p>
<p>It's easy to get Node.js setup with a Windows machine:</p>
<ol style="list-style-type: decimal">
<li>Download the .msi file from <a href="http://nodejs.org/download/">here</a></li>
<li>Use Windows Installer to get it set up.</li>
</ol>
<p><em>Linux</em></p>
<p>There are about a million different ways to install things on various Linux-based operating systems. Go to <a href="https://github.com/joyent/node/wiki/installing-node.js-via-package-manager">this link</a> for a full list.</p>
<p>Alright, let's get started.</p>
<h3 id="what-is-a-nodejs-app">What is a NodeJS app?</h3>
<p>Node is a very common Javascript-based web framework. In other words, it's a structure for making websites that many people use where the app/server logic is written mostly in Javascript. It's great because it has modules, which are bits of code other people write that can easily be added to give new functionality to your app. NodeJS has the most modules of most modern web frameworks, and that's part of what makes it really great for writing webapps fast.</p>
<h3 id="the-anatomy-of-a-node-app">The Anatomy of a Node app</h3>
<p>A common Node app has several main components, as described below:</p>
<p><em>app.js:</em> The main file, and the first one to be read. At the beginning, this file initializes the functionality described in the Node modules. Then &quot;get&quot; and &quot;post&quot; requests are set up that tell the app which router methods to use. The last section tells the app to run on a particular port (3000 in this case).</p>
<p><em>package.json:</em> A standardized JSON file containing information about this app. It's fairly readable, but there's info about the authors, version, repository, and versions of Node modules.</p>
<p><em>node_modules:</em> Contains external modules, which are snippets of code written by others that perform very specific functions within your code. These are really what make Node so powerful and flexibleâ€”you can easily import functionality written by other people. You can look through Node modules on http://www.npmjs.org, or just Google functionality you want and look for modules that perform that function. To add a new Node module to your program, type &quot;npm install [[module name]]&quot; in the main directory of your program.</p>
<p>One very common module, Express, provides a lot of the framework to make our app work over the Internet.</p>
<p><em>public:</em> Holds CSS, Javascript, image, and video files used to render web pages.</p>
<p><em>routes:</em> Contains the routing files. The routing files tell your app what to do and where to go when deliniated functions are performed. For example, a routing file can tell the application when to render the different web pages, and how to send your name from one web page to the next.</p>
<p><em>views:</em> Contains files that are actually rendered. This folder contains HJS, or Hogan.js, files. HJS is essentially HTML, but with a few extra features that make it easier to use.</p>
<h3 id="running-a-node-app">Running a Node app</h3>
<p>To run on Mac/Linux, bring up a normal terminal window. On Windows, search your computer for the Node.js Command Prompt application, and open it (it should look very similar to the normal command prompt).</p>
<p>Enter the folder the contains your Node app with simple terminal commands like &quot;cd&quot;. Once there, type &quot;node&quot; and hit enter. If you see a blank line that starts with &quot;&gt;&quot;, Node is installed properly and you're ready to go. If not, go back to the installation instructions and reinstall.</p>
<p>The first time you run a node app, cd into the directory and run <code>npm install</code>. To run the Node app, type <code>node app.js</code> into the terminal from the folder that contains app.js.</p>
<p>To see the app working, pull up an Internet browser. In the address bar, enter <code>localhost:3000</code>. If all goes well, you should be able to see your app!</p>
<h3 id="writing-our-first-nodejs-app">Writing our first NodeJS app</h3>
<p>Download <a href="assets/files/ws2-start.zip">this file</a> to get the directory structure and files we need to start off with.</p>
<p>Let's start off by looking at the code that's already there in the package.json file, and then moving on to the code we need to write in app.js.</p>
<h4 id="package.json">Package.json</h4>
<p>This is a basic JSON file that describes the app we're building and its associated dependencies. Dependencies are basically modules, or other pieces of software that somebody else made, that lets us do things like use Express, the module that makes it really easy to create webapps using NodeJS.</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="er">Name:</span> <span class="er">Module</span> <span class="er">name</span> 
<span class="er">Version:</span> <span class="er">Version</span> <span class="er">number</span> 
<span class="er">Private:</span> <span class="er">Keep</span> <span class="er">npm</span> <span class="er">repo</span> <span class="er">private</span> 
<span class="er">Dependencies:</span> <span class="er">Automatically</span> <span class="er">installed</span> <span class="er">when</span> <span class="er">people</span> <span class="er">install</span> <span class="er">your</span> <span class="er">app</span> </code></pre>
<h4 id="app.js">App.js</h4>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> path = <span class="fu">require</span>(<span class="st">&#39;path&#39;</span>); 
<span class="kw">var</span> logger = <span class="fu">require</span>(<span class="st">&#39;morgan&#39;</span>); 
<span class="kw">var</span> express = <span class="fu">require</span>(<span class="st">&#39;express&#39;</span>); 
<span class="kw">var</span> cookieParser = <span class="fu">require</span>(<span class="st">&#39;cookie-parser&#39;</span>); 
<span class="kw">var</span> bodyParser = <span class="fu">require</span>(<span class="st">&#39;body-parser&#39;</span>); 
<span class="kw">var</span> session = <span class="fu">require</span>(<span class="st">&#39;cookie-session&#39;</span>);</code></pre>
<p>We start off by obtaining all of the required resources and packages for the application that we're going to use later on. We can do this in Node by using the <code>require('name of module')</code> syntax. <code>name of module</code> can either be the name of some module you specified or the path to a file. Morgan is an HTTP request logger middleware for NodeJS (don't worry if you don't udnerstand that, this isn't too important and the app won't break if we get rid of it). Cookie-parser allows us to parse and use cookies with signatures. Cookie-session is a module which provides &quot;guest&quot; sessions, meaning any visitor will have a session, authenticated or not. If a session is new a Set-Cookie will be produced regardless of populating the session. We'll see more of both cookie modules - and their applications in our web app - a little later on.</p>
<p>Now that we've stated what we need, let's instantiate our app:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> app = <span class="fu">express</span>();</code></pre>
<p>Express is a minimal and flexible NodeJS web application framework that provides a robust set of features for web and mobile applications. This line both instantiates Express and assigns our variable <code>app</code> to it.</p>
<p>We should now tell the app where to find the views (HTML templates/files) it needs, what engines to render them with (we're going to use HJS, you can find more on the tempalte syntax it uses <a href="http://mustache.github.io/mustache.5.html">here</a>) and which methods to use to get things up and running (just telling our app to use the logger and parsers we defined above, setting the secret that we use to encrypt cookies that store session information and telling the app where to look for public files like CSS, and frontend Javascript).</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">app</span>.<span class="fu">set</span>(<span class="st">&#39;views&#39;</span>, <span class="ot">path</span>.<span class="fu">join</span>(__dirname, <span class="st">&#39;views&#39;</span>)); 
<span class="ot">app</span>.<span class="fu">set</span>(<span class="st">&#39;view engine&#39;</span>, <span class="st">&#39;hjs&#39;</span>); 
<span class="ot">app</span>.<span class="fu">set</span>(<span class="st">&#39;port&#39;</span>, <span class="ot">process</span>.<span class="ot">env</span>.<span class="fu">PORT</span> || <span class="dv">3000</span>);

<span class="ot">app</span>.<span class="fu">use</span>(<span class="fu">logger</span>(<span class="st">&#39;dev&#39;</span>)); 
<span class="ot">app</span>.<span class="fu">use</span>(<span class="ot">bodyParser</span>.<span class="fu">urlencoded</span>({<span class="dt">extended</span>: <span class="kw">false</span>})); 
<span class="ot">app</span>.<span class="fu">use</span>(<span class="fu">cookieParser</span>()); 
<span class="ot">app</span>.<span class="fu">use</span>(<span class="fu">session</span>({<span class="dt">secret</span>: <span class="st">&#39;codeweekend&#39;</span>})); 
<span class="ot">app</span>.<span class="fu">use</span>(<span class="ot">express</span>.<span class="fu">static</span>(<span class="ot">path</span>.<span class="fu">join</span>(__dirname, <span class="st">&#39;public&#39;</span>)));</code></pre>
<p>Note how the last line tells the app to treat the folder directory like the top-level.</p>
<p>It's always important to look out for paths that don't exist (like google.com/kasjdhfkjashdfkjashdfkajsdhfkjsda), and let's make sure our app does the same:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">app</span>.<span class="fu">use</span>(<span class="kw">function</span>(req, res, next) { 
  <span class="kw">var</span> err = <span class="kw">new</span> <span class="fu">Error</span>(<span class="st">&#39;Not Found&#39;</span>); 
  <span class="ot">err</span>.<span class="fu">status</span> = <span class="dv">404</span>; 
  <span class="fu">next</span>(err); 
}); 

<span class="ot">app</span>.<span class="fu">use</span>(<span class="kw">function</span>(err, req, res, next) { 
  <span class="ot">res</span>.<span class="fu">status</span>(<span class="ot">err</span>.<span class="fu">status</span> || <span class="dv">500</span>); 
  <span class="ot">res</span>.<span class="fu">render</span>(<span class="st">&#39;error&#39;</span>, { 
    <span class="dt">errorMessage</span>: <span class="ot">err</span>.<span class="fu">message</span>, 
    <span class="dt">error</span>: <span class="ot">app</span>.<span class="fu">get</span>(<span class="st">&#39;env&#39;</span>) === <span class="st">&#39;development&#39;</span> ? err : {} 
  }); 
});</code></pre>
<p>This catches 404 errors (ie, this path doesn't exist) and forwards them to our error handler, which prints out a bunch of error info, since we're really in a developer environment/debugging mode.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> routes = <span class="fu">require</span>(<span class="st">&#39;./routes&#39;</span>);
<span class="ot">app</span>.<span class="fu">use</span>(<span class="st">&#39;/&#39;</span>, routes);</code></pre>
<p>These lines initialize our routes. Routes are basically what tells our app what to do when the user goes to a certain url within our website. For example, going to google.com/mail corresponds to the '/mail' route as far as Google's backend is concerned. By requiring the <code>'./routes'</code> file, we're saying that we've stored our routes in a separate file, and the next line tells node to look there for all its routes. We'll take a look at the routes file soon.</p>
<p>And finally, to get the app really off the ground and make it actually work for someone trying to reach our website, let's make it listen for requests.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">app</span>.<span class="fu">listen</span>(<span class="ot">app</span>.<span class="fu">get</span>(<span class="st">&#39;port&#39;</span>), <span class="kw">function</span>() { 
  <span class="ot">console</span>.<span class="fu">log</span>(<span class="st">&#39;Express server listening on port &#39;</span> + <span class="ot">app</span>.<span class="fu">get</span>(<span class="st">&#39;port&#39;</span>)); 
});</code></pre>
<p>We'll use the port and resources we defined earlier on.</p>
<p>We can also add in some middleware, which is code that runs in before routes are searched for by the app. In this case we use:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">app</span>.<span class="fu">use</span>(<span class="kw">function</span>(req, res, next) { 
  <span class="kw">if</span> (<span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span>) { 
    <span class="ot">res</span>.<span class="ot">locals</span>.<span class="fu">message</span> = <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span>; 
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="kw">null</span>; 
  }

  <span class="kw">if</span> (!<span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">notes</span>) { 
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">notes</span> = []; 
  }

  <span class="fu">next</span>(); 
});</code></pre>
<p>If we get session messages, we set them to our local state. And if no session notes exist, let's make an empty collection for them. We'll use this nifty code soon to create and store notes in the user's browser cookies.</p>
<h4 id="routes.js">routes.js</h4>
<p>Let's talk about a file called routes.js. This handles all the &quot;middleware routing&quot;: that our app has to do. So basically it tells our app what to do when someone goes to google.com/mail or to google.com/maps, ie, it specifies the behavior and results for making GET/POST requests at different routes (or paths). To begin with, as usual, we'll get the Express variable. Except this time, we'll specify a new variable called router which is created as folows:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> express = <span class="fu">require</span>(<span class="st">&#39;express&#39;</span>);
<span class="kw">var</span> router = <span class="ot">express</span>.<span class="fu">Router</span>();</code></pre>
<p>A router is an isolated instance of middleware and routes. Routers can be thought of as &quot;mini&quot; applications, capable only of performing middleware and routing functions. Every express application has a built-in app router.</p>
<p>Routers behave like middleware themselves and can be <code>.use()</code>d by the app or in other routers.</p>
<p>We'll now make simple route definitions for the HTTP GET method as below:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">router</span>.<span class="fu">get</span>(<span class="st">&#39;/&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">render</span>(<span class="st">&#39;index&#39;</span>, {
    <span class="dt">title</span>: <span class="st">&#39;Codeweekend Notes&#39;</span>,
    <span class="dt">notes</span>: <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">notes</span>
  });
});

<span class="ot">router</span>.<span class="fu">get</span>(<span class="st">&#39;/:id&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="kw">var</span> noteId = <span class="fu">Number</span>(<span class="ot">req</span>.<span class="ot">params</span>.<span class="fu">id</span>);
  <span class="kw">if</span> (<span class="fu">isNaN</span>(noteId) || noteId &lt; <span class="dv">1</span> || noteId &gt; <span class="ot">req</span>.<span class="ot">session</span>.<span class="ot">notes</span>.<span class="fu">length</span>) {
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;That note does not exist!&#39;</span>;
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);
  }

  <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">render</span>(<span class="st">&#39;note&#39;</span>, {
    <span class="dt">note</span>: <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">notes</span>[noteId - <span class="dv">1</span>]
  });
});

<span class="ot">router</span>.<span class="fu">post</span>(<span class="st">&#39;/create&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="kw">if</span> (!(<span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">title</span> &amp;&amp; <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">body</span>)) {
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;You must provide a title and a body!&#39;</span>;
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);
  }

  <span class="ot">req</span>.<span class="ot">session</span>.<span class="ot">notes</span>.<span class="fu">push</span>({
    <span class="dt">id</span>: <span class="ot">req</span>.<span class="ot">session</span>.<span class="ot">notes</span>.<span class="fu">length</span> + <span class="dv">1</span>,
    <span class="dt">title</span>: <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">title</span>,
    <span class="dt">body</span>: <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">body</span>
  });

  <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;Note created!&#39;</span>;
  <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);
});</code></pre>
<p>You'll notice that the first function specifies what is supposed to happen when a simple route path is requested (such as '/'). Each all to <code>router.get</code> or <code>router.post</code> takes a callback function that has two objects <code>req</code> and <code>res</code>. The <code>req</code> object usually contains information that is containted in the request. It also gives us access to the session cookie so that we can access and store some information about the user in their browser. The <code>res</code> object let's us control the response. Thus <code>res.redirect</code> redirects the user to another page and <code>res.render</code> uses our templating engine to create a webpage that we send back to the user.</p>
<p>Whenever we have an error in the request made to our webapp, we can see that we store the error message into the session and return a redirect back to the simply routing path using this nifty structure inside the callback functions:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;Error message goes here&#39;</span>;
<span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);</code></pre>
<p>This allows for clean error handling since we always send users to the same page when they get an error, and the actual error message is bound to the user's cookie, not the page itself.</p>
<p>And lastly, just so that we get all this handy code available to the rest of the application, let's export it with:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">module</span>.<span class="fu">exports</span> = router;</code></pre>
<h4 id="views">Views</h4>
<p>As you may have already noticed, there's another folder in our project files called Views. This is where you write the front-end of the application. The front-end is basically the part of the website that the users see and interact with, the HTML/CSS/Javascript that we've seen in the last workshop. Let's break it down by looking at what each file is supposed to do and how it does it. First, we have:</p>
<h4 id="index.hjs">index.hjs</h4>
<p>As we can see, most of the code follows from the very basic HTML structure you saw earlier on in the first workshop. This file builds the first landing page for the application and a basic web form for creating a new one.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html&gt;</span>
  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>{{ title }}<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&#39;stylesheet&#39;</span><span class="ot"> href=</span><span class="st">&#39;/stylesheets/style.css&#39;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>
  <span class="kw">&lt;body&gt;</span>
    <span class="kw">&lt;h1&gt;</span>{{ title }}<span class="kw">&lt;/h1&gt;</span>
    {{#message}}
      <span class="kw">&lt;h3&gt;</span>{{message}}<span class="kw">&lt;/h3&gt;</span>
    {{/message}}
    <span class="kw">&lt;p&gt;</span>Welcome to {{ title }}. Your notes:<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;ul&gt;</span>
    {{#notes}}
      <span class="kw">&lt;li&gt;&lt;a</span><span class="ot"> href=</span><span class="st">&#39;/{{ id }}&#39;</span><span class="kw">&gt;</span>{{ title }}<span class="kw">&lt;/a&gt;&lt;/li&gt;</span>
    {{/notes}}
    {{^notes}}
      <span class="kw">&lt;li&gt;</span>You don&#39;t have any notes yet!<span class="kw">&lt;/li&gt;</span>
    {{/notes}}
    <span class="kw">&lt;/ul&gt;</span>
    <span class="kw">&lt;p&gt;</span>Make a new note:<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;form</span><span class="ot"> action=</span><span class="st">&#39;/create&#39;</span><span class="ot"> method=</span><span class="st">&#39;post&#39;</span><span class="kw">&gt;</span>
      <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&#39;text&#39;</span><span class="ot"> name=</span><span class="st">&#39;title&#39;</span><span class="ot"> placeholder=</span><span class="st">&#39;Title&#39;</span><span class="kw">&gt;&lt;br/&gt;</span>
      <span class="kw">&lt;textarea</span><span class="ot"> name=</span><span class="st">&#39;body&#39;</span><span class="ot"> rows=</span><span class="st">&#39;8&#39;</span><span class="ot"> cols=</span><span class="st">&#39;80&#39;</span><span class="ot"> placeholder=</span><span class="st">&#39;Body&#39;</span><span class="kw">&gt;&lt;/textarea&gt;&lt;br/&gt;</span>
      <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&#39;submit&#39;</span><span class="ot"> value=</span><span class="st">&#39;Save Note&#39;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;/form&gt;</span>
  <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>If you look carefully, you'll see that some parts of this code are a little different from the basic syntax we introduced you to. That's right, you're probably confused about what lines of code like this mean:</p>
<pre class="sourceCode html"><code class="sourceCode html">{{ title }}</code></pre>
<p>The way this works, is that the application dynamically treats these fields as variables and fills them in when the app is run. It then sends the filled in HTML file to the client's web browser. In this way, we only ever have to state, for example, the title of the application, once while sending the command to render the template - and it'll change everywhere around the views.</p>
<p>The page gets access to all these variables from the object that gets passed to the page when we use <code>res.render</code> from our Node backend. So <code>{{ title }}</code> just prints out whatever the contents of the attribute <code>title</code> is from that object. The syntax <code>{{#notes}}</code> is the same as saying &quot;if the notes attribute is non-empty/non-null, then display everything between this and <code>{{/notes}}</code>&quot; and <code>{{^notes}}</code> is the same idea, but if the notes variable is empty/null.</p>
<p>Let's now move on to the next view.</p>
<h4 id="error.hjs">error.hjs</h4>
<p>The code in this file is mainly used to build a generic view for any error that our application may have to handle and process.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html&gt;</span>
  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Error<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&#39;stylesheet&#39;</span><span class="ot"> href=</span><span class="st">&#39;/stylesheets/style.css&#39;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>
  <span class="kw">&lt;body&gt;</span>
    <span class="kw">&lt;h1&gt;</span>{{ errorMessage }}<span class="kw">&lt;/h1&gt;</span>
    {{#error}}
      <span class="kw">&lt;h3&gt;</span>{{ status }}<span class="kw">&lt;/h3&gt;</span>
      <span class="kw">&lt;pre&gt;</span>{{ stack }}<span class="kw">&lt;/pre&gt;</span>
    {{/error}}
  <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>As you can see above, the <code>errorMessage</code>, <code>status</code> and <code>stack</code> will all be dynamically completed, depending on the error. This means the screen will be structually identical for any error that we display - even if the content is different.</p>
<h4 id="note.hjs">note.hjs</h4>
<p>This file works in a similar manner to the previous error.hjs file, in that it uses static HTML code to create a structurally identical page to display notes in, with dynamically loaded varied content.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;html&gt;</span>
  <span class="kw">&lt;head&gt;</span>
    <span class="kw">&lt;title&gt;</span>Note: {{ note.title }}<span class="kw">&lt;/title&gt;</span>
    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&#39;stylesheet&#39;</span><span class="ot"> href=</span><span class="st">&#39;/stylesheets/style.css&#39;</span> <span class="kw">/&gt;</span>
  <span class="kw">&lt;/head&gt;</span>
  <span class="kw">&lt;body&gt;</span>
    {{#message}}
      <span class="kw">&lt;h3&gt;</span>{{message}}<span class="kw">&lt;/h3&gt;</span>
    {{/message}}
    <span class="kw">&lt;h1&gt;</span>{{ note.title }}<span class="kw">&lt;/h1&gt;</span>
    <span class="kw">&lt;p&gt;</span>{{ note.body }}<span class="kw">&lt;/p&gt;</span>
    <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&#39;/&#39;</span><span class="kw">&gt;</span>Go back<span class="kw">&lt;/a&gt;</span>
  <span class="kw">&lt;/body&gt;</span>
<span class="kw">&lt;/html&gt;</span></code></pre>
<p>In this specific case, tags such as note.title or note.body are loaded and populated once the application is run.</p>
<h4 id="files-1">Files</h4>
<p><a href="assets/files/ws2.zip">This ZIP file</a> contains a snapshot of what your code should look like at the end of this workshop.</p>
<h1 id="intro-to-apis">Intro to APIs <a id="api-section"></a></h1>
<h2 id="adding-the-internet-to-your-app">Adding the internet to your app</h2>
<p>Topics to be covered:</p>
<ul>
<li>What APIs are, how they work, why we use them</li>
<li>Sending HTTP requests from Node</li>
<li>Authenticating with an API via OAuth</li>
<li>Sending emails and Venmo payments</li>
</ul>
<h4 id="whats-an-api">What's an API?</h4>
<p>APIs are basically ways to interact with, or access data, on other parts of the internet that are not our own website. So we can make requests of teh Rotten Tomatoes API to pull movie information into our website, or use the Facebook API to let people login and import their credentials to our website. For this workshop we're going to be using the Venmo API to send payments to our friends.</p>
<h4 id="before-that-oauth">Before that, OAuth</h4>
<p>OAuth is what makes interacting with other APIs secure. It allows us to sign into spammygames.com using our Facebook login, without compromising our Facebook credentials since what actually happens is that spammygames.com send us to Facebook.com where we log in. Facebook then sends back a token to spammygames.com asking it to verify that it signed up with facebook to be a developer and they send back their credentials to Facebook. On seeing that both the user and the website have valid credentials, Facebook now send back an access token taht the website can use to access thsi particular user's data. This is often called 2-legged oauth, since there are two steps to it.</p>
<div class="figure">
<img src="assets/img/ws3.jpg" alt="OAuth" />
<p class="caption">OAuth</p>
</div>
<p>For the Venmo API to work, it's important to get these keys. You'll have to go to the <a href="https://venmo.com/account/settings/developers">Venmo Developer Console</a> and create a new app. Then you should be able to get your 'Secret' and 'ID' that you should add into your code as shown a little below. Also make sure to set your web redirect url to 'http://localhost:3000/venmo/oauth'. Time to get to some real code.</p>
<h4 id="preppin-app.js-for-our-api">Preppin' app.js for our API</h4>
<p>First open app.js. We need to set our Node app to try to reach venmo if someone using the app goes to localhost:3000/venmo. This is a route that takes us into venmo.js, and, importantly, relativizes the URL so that what here is /venmo/foo looks to venmo.js just like /foo.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> venmo = <span class="fu">require</span>(<span class="st">&#39;./venmo&#39;</span>);
<span class="ot">app</span>.<span class="fu">use</span>(<span class="st">&#39;/venmo&#39;</span>, venmo);</code></pre>
<h4 id="where-all-the-venmo-happens-venmo.js">Where all the venmo happens : venmo.js</h4>
<p>In the same directory as your other .js files, write to venmo.js. We'll go through it line by line. First off, list dependencies, request, express, and router, which you've used before. We won't focus on those now, but to review:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> request = <span class="fu">require</span>(<span class="st">&#39;request&#39;</span>);
<span class="kw">var</span> express = <span class="fu">require</span>(<span class="st">&#39;express&#39;</span>);</code></pre>
<p>We'll use the express router.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> router = <span class="ot">express</span>.<span class="fu">Router</span>();</code></pre>
<p>Now we get into config with Venmo. We need Venmo to know our requests are legit, so you'll need to be a venmo developer. You can do that <a href="https://venmo.com/account/settings/developers">here.</a></p>
<p>Once you've done that, make a new application, and it'll give you the ID and the Secret. Make sure as well to set Web Redirect Url, under the application page, to <code>http://localhost:300/venmo/oauth</code>. Once you've gone through with that, let's go over the rest of the code.</p>
<p>First off after the five lines of Venmo config are three separate routes, for</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="st">&#39;/&#39;</span>
<span class="st">&#39;/authorize&#39;</span>
<span class="st">&#39;/oauth&#39;</span></code></pre>
<p>As you know, each of these routes is activated when the proper URL is requested by your app's adoring fans. As a reminder, the fact that the function call is &quot;router.get&quot; does not mean you're &quot;getting&quot; something from the router (like Java's ArrayList.get()), it means it's responding to a HTTP GET call from the browser.</p>
<p>Let's go through each of the routes. First up is the &quot;root&quot; or &quot;/&quot; venmo page. First off, we initialize the variable venmo.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">venmo = {};</code></pre>
<p>This variable will hold the user's venmo information. The next thing we do is check to see if we have a cookie with the info (meaning the user has already logged in). Regardless, it then renders &quot;venmo.hjs&quot;, the actual HTML document that the user will see. We'll go over this in a bit.</p>
<p>Second up is <code>'/authorize'</code>. The user clicks on a link from the root venmo page to come here, and its one line of code is why you had to tell venmo what your Web Redirect URL was. When the user hits this page, you hand them off to venmo (notice how you send them the authorizeUrl defined at the top of the file.) Venmo then sends them back to &quot;/oauth&quot;, which is the path you define next!</p>
<p>The next route in our venmo app, <code>'/oauth'</code>, is the second part of venmo's verification process. We already sent the user to Venmo so that Venmo could tell us they were all set. They called our <code>/oauth</code> page, and passed it req.query.code if the authorization went well. The first if statement under router.get('oauth') simply means that if the authorization failed, we don't continue with the exchange.</p>
<p>In the event that the authorization went through, Venmo needs to verify us as a developer. This is the request module comes into play. We actually have to make a call directly to Venmo's website (using their API). Notice that we're using a POST request, sending them both our unique clientId and clientSecret, and req.query.code, which venmo sent back to us. If this all checks out on Venmo's side, what we get back,</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">venmo</span> = <span class="ot">JSON</span>.<span class="fu">parse</span>(body)</code></pre>
<p>is a session from venmo that's unique between your application and your client, so venmo knows that future payment requests are legit. If all goes well, it prints a notice to the user that they've been authenticated, and redirects them to your app's venmo hompage.</p>
<p>Okay, so, our last route in venmo.js, <code>router.post('/send')</code>, is where the magic happens. Handshakes have gone through, and if your user types in the amount, phone #, and note fields properly (checked by the first if statement), you're ready to do a payment.</p>
<p>This takes the form of another POST request to Venmo's API. You send them the relevant transfer information, as well as the unique user/client token that you generated in &quot;/oauth.&quot; The following code defines how you handle this.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">router</span>.<span class="fu">post</span>(<span class="st">&#39;/send&#39;</span>, <span class="kw">function</span>(req, res, next) {
  <span class="kw">var</span> amount = <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">amount</span>;
  <span class="kw">var</span> phone = <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">phone</span>;
  <span class="kw">var</span> note = <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">note</span>;

  <span class="kw">if</span> (!(amount &amp;&amp; phone &amp;&amp; note)) {
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;You must provide all three fields!&#39;</span>;
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/venmo&#39;</span>);
  }

  <span class="ot">request</span>.<span class="fu">post</span>({
    <span class="dt">url</span>: paymentUrl,
    <span class="dt">form</span>: {
      <span class="dt">access_token</span>: <span class="ot">req</span>.<span class="ot">session</span>.<span class="ot">venmo</span>.<span class="fu">access_token</span>,
      <span class="dt">phone</span>: phone,
      <span class="dt">amount</span>: amount,
      <span class="dt">note</span>: note
    }
  }, <span class="kw">function</span>(err, response, body) {
    <span class="kw">if</span> (err) {
      <span class="fu">next</span>(err);
    }

    <span class="kw">var</span> recipient = <span class="ot">JSON</span>.<span class="fu">parse</span>(body).<span class="ot">data</span>.<span class="ot">payment</span>.<span class="ot">target</span>.<span class="ot">user</span>.<span class="fu">display_name</span>;
    <span class="ot">req</span>.<span class="ot">db</span>.<span class="fu">collection</span>(<span class="st">&#39;payments&#39;</span>).<span class="fu">insert</span>({
      <span class="dt">amount</span>: amount,
      <span class="dt">phone</span>: phone,
      <span class="dt">note</span>: note,
      <span class="dt">recipient</span>: recipient,
      <span class="dt">date</span>: <span class="ot">Date</span>.<span class="fu">now</span>()
    }, <span class="kw">function</span>(err, result) {
      <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;Sent $&#39;</span> + amount + <span class="st">&#39; to &#39;</span> + recipient + <span class="st">&#39; successfully!&#39;</span>;
      <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/venmo&#39;</span>);
    });
  });
});</code></pre>
<p>Take a peek at this portion of the function in the callback to <code>request.post</code> here and in context in venmo.js. First, it checks to see if venmo returned an error. If not, it continues, and parses the Venmo response for user data. Finally, it prints a message to the user telling them that the payment was successful as it redirects them back to the root venmo page!</p>
<h4 id="okay-but-were-not-done-yet">Okay, but we're not done yet</h4>
<p>So, especially if you learned HTML/CSS earlier this weekend, you may be wondering, &quot;what actually is determining what the user sees at page /vemno?&quot; What a great question! They're seeing <code>views/venmo.hjs</code>!</p>
<p>So, you've seen .hjs before, but to recap, the biggest difference between .hjs and html is that you update certain parts of it dynamically based on what we tell NodeJS. So, if you remember in the last block of code,</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&quot;yodelyodelyoda&quot;</span></code></pre>
<p>In venmo.hjs, when you see</p>
<pre class="sourceCode html"><code class="sourceCode html">{{#message}}
    <span class="kw">&lt;h3&gt;</span>{{message}}<span class="kw">&lt;/h3&gt;</span>
{{/message}}</code></pre>
<p>You're taking req.session.message and inserting it into {{message}} in venmo.hjs!</p>
<p>Take note that the field,</p>
<p><code>{{#message}}</code> means &quot;if this field is present, show the following&quot;,</p>
<p><code>{{^message}}</code> means &quot;if this field is not present, show the following&quot;, and</p>
<p><code>{{/message}}</code> just closes these blocks.</p>
<p>This becomes more important at the next &quot;if statement&quot;,</p>
<pre class="sourceCode html"><code class="sourceCode html">{{#venmo}}
    code
{{/venmo}}</code></pre>
<p>There's a lot of code between these tags, and none of it is shown unless the &quot;venmo&quot; field, denoting that the user has authenticated, is present. This is important, because not only does the venmo variable decide what would be shown if you happened to include <code>{{venmo}}</code> as part of the text, but it actually acts as an &quot;if&quot; statement for what should be shown to the user.</p>
<p>So, let's assume that the user has authenticated. In this case, it shows the fields <code>{{display_name}}</code> and <code>{{username}}</code>, and most importantly, includes a <code>&lt;form&gt;</code>. Let's see the whole thing:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form</span><span class="ot"> action=</span><span class="st">&#39;/venmo/send&#39;</span><span class="ot"> method=</span><span class="st">&#39;post&#39;</span><span class="kw">&gt;</span>
    Pay $<span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&#39;text&#39;</span><span class="ot"> name=</span><span class="st">&#39;amount&#39;</span><span class="ot"> placeholder=</span><span class="st">&#39;Amount in dollars&#39;</span><span class="kw">&gt;</span> to
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&#39;text&#39;</span><span class="ot"> name=</span><span class="st">&#39;phone&#39;</span><span class="ot"> placeholder=</span><span class="st">&#39;Phone Number&#39;</span><span class="kw">&gt;</span> for:<span class="kw">&lt;br/&gt;</span>
    <span class="kw">&lt;textarea</span><span class="ot"> name=</span><span class="st">&#39;note&#39;</span><span class="ot"> rows=</span><span class="st">&#39;3&#39;</span><span class="ot"> cols=</span><span class="st">&#39;80&#39;</span><span class="ot"> placeholder=</span><span class="st">&#39;For...&#39;</span><span class="kw">&gt;&lt;/textarea&gt;</span>           <span class="kw">&lt;br/&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&#39;submit&#39;</span><span class="ot"> name=</span><span class="st">&#39;Send Payment&#39;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>The form action designates what type of call the the browser will make when the form is submitted. In this case, the form is for the user to actually make a payment, and we have a venmo.js route that we created to handle a POST request to /venmo/send, so we want the browser to send the request to that URL (action='/venmo/send'), with POST (method='post').</p>
<p>In this form, there are 3 input fields. The first is the total amount of money being transfered. While we will parse it as a decimal, its input <code>type='text'</code>. The 'name' field we use to tell our app what variable it is assigned to, so we can access it in venmo.js. The placeholder, as you can probably tell, determines what is shown when the user has not yet typed anything in.</p>
<p>The next form is, by most measures, the same. Make sure to note, however, that the field name is assigned the value 'phone', again so we can reference the input as a variable by that name in venmo.js. The third field is of type <code>&lt;textarea&gt;</code> instead of type <code>&lt;input&gt;</code>. The biggest difference between a textarea and an input to understand is that a textarea has better accounting for large input of paragraph-length. Note that we specify the field <code>rows='3'</code>, and <code>cols='80'</code>. Thus, unlike an <code>&lt;input&gt;</code>, we can guess that this field might be a sentence or two but probably no longer, and tailor the size of hte textfield to that. Furthermore, it handles newlines well, so the user can happily use multiple paragraphs.</p>
<p>The final important piece of your form is <code>&lt;input type='submit' name='Send Payment.'&gt;</code>. Note that the <code>type='submit'</code> field is not specifying a variable, but is a keyword in your form that your browser knows to interpret as a submission of the form. the name field determines what is shown on the button. Because this submit button is within the same form as the other input fields (see that it comes before the ending <code>&lt;/form&gt;</code> tag), it will submit everything within that form.</p>
<p>Notice now the end tag {{/venmo}}. This is the end of our if statement. i.e., if the user hadn't authenticated yet, she would have seen none of what we just went over. Now, on the next lines, we see</p>
<pre class="sourceCode html"><code class="sourceCode html">{{^venmo}}
    <span class="kw">&lt;p&gt;</span>You have not authorized yet. <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&#39;authorize&#39;</span><span class="kw">&gt;</span>Click here<span class="kw">&lt;/a&gt;</span> to authorize with Venmo.<span class="kw">&lt;/p&gt;</span>
{{/venmo}}</code></pre>
<p>So, if <code>{{#venmo}}</code> is the beginning of an if statement, <code>{{^venmo}}</code> is the beginning of an &quot;if not&quot; statement. Thus, the first time your user sees a venmo page, since they will not yet have authenticated, this statement will return &quot;true&quot;, and they'll be given the link to the &quot;authorize&quot; page, and be allowed to authorize. Not very tricky, very cool. As always, make sure to end your if with a <code>{{/venmo}}</code>, just like you always remember to end your <strong> tags, right? Right. ... </strong>.</p>
<h4 id="files-2">Files</h4>
<p><a href="assets/files/ws3.zip">This zip file</a> contains what you should have at the end of this workshop.</p>
<h1 id="intro-to-databases">Intro to Databases <a id="db-section"></a></h1>
<h2 id="making-information-stick-around">Making information stick around</h2>
<p>Topics to be covered:</p>
<ul>
<li>MongoDB: what it is, how to use it</li>
<li>Why we pair MongoDB with Node and how</li>
<li>Persisting our prior inputs</li>
<li>Basic login authentication</li>
</ul>
<h3 id="installing-mongodb">Installing MongoDB</h3>
<p>Let's move on to MongoDB. Mongo is a NoSQL Database, so all data is stored as key-value pairs, similar to JSON. Of course, this being a database, we can store, search and access large amounts of data very quickly.</p>
<p><em>Mac</em></p>
<p>Assuming you have Homebrew installed by this point you can just type <code>brew install mongodb</code> into terminal. Then, if all goes well, mongodb should show you three different commands that you should copy-paste into Terminal and run. Before you start mongo for the first time, type this into Terminal: <code>mkdir -p /data/db</code>. You should now be able to go straight into the MongoDB shell by typing in <code>mongod</code> into Terminal.</p>
<p>In case you run into any problems, <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/">look at MongoDB's full instructions page</a> and Google around before asking mentors for help.</p>
<p><em>Windows</em></p>
<p>MongoDB has a full set of instructions <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-windows/">here</a> that you should follow through till you can run MongoDB. You most probably just need to install the 64-bit version of MongoDB using their installation file. Before you run Mongo for the first time, you'd need to run this from Command Prompt: <code>md \data\db</code>. Follow the instructions on the above link to run MongoDB.</p>
<p><em>Linux</em></p>
<p>Full instructions to install MongoDB on Linux can be found <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/">here</a>.</p>
<h3 id="running-mongodb">Running MongoDB</h3>
<p>Just type in <code>mongod</code> into Terminal before you run your node app. On Windows, you might need to find and double-click the mongod.exe file (itprobably at <code>C:\Program Files\MongoDB\bin\mongod.exe</code>).</p>
<h3 id="why-use-a-database-and-why-mongodb">Why use a database? And why MongoDB?</h3>
<p>Databases are these other kinds of web development things, separate from the webapp itself, where all we do is store information. They make it easy to store and access large amounts of data very quickly and efficiently. All important information, such as user accounts, catalogues, prices, wall posts, tweets etc. across any major website, app or anything else that runs on computers probably stores this information in a database.</p>
<p>So we've been storing information in the user's cookies till now, why use a database? After all, doesn't it make sense to distribute this information across everyones computers rather than have everything in one place?</p>
<p>Well there's a lot of reasons why not, but here's a few major ones. First, not all information is relevant to a user, and users don't neccessarily have a lot fo space on their devices. You don't want Amazon's entire catalogue on you iPhone. Cookies are best kept for storing information specific to a user that we can afoord to loose. Which leads us to our next point, which is that cookeis are easily deleted. All a user needs to do is hit the &quot;Clear Cookies&quot; button in theri settings menu. So obviously, this isn't reliable.</p>
<p>So databases let us store the information our website needs close to us, making it faster for us to get access to the correct information, as needed, to serve to our users. They make it possible to efficiently store a lot of information and access it quickly. But this means an extra layer of trouble dealing with asking our database for data and sending it new data from our webapp.</p>
<p>That's why MongoDB is so popular with NodeJS. While it is still a separate database, it stores its information in a large JSON file. That's right, just JSON. So when we ask Mongo for results, it can jsut give us an array of javascript objects and that means we don't have to worry about the formatting of the data, cause it's already in the format we need! You might hear people argue for the use of MongoDB because it's a NoSQL database, but this has a lot of tradeoffs and there's no clear cut winner between SQL and NoSQL; they've each more apporpriate for different sets of circumstances.</p>
<h3 id="now-for-the-code">Now for the code!</h3>
<p>We're now going to integrate a database into our application to store data. A really popular database to use with NodeJS is MongoDB. It's a document database (basically the entire thing is one JSON document) that provides high performance, high availability and easy scalability. The first thing we're going to have to do is add MongoDB to our dependencies list inside of <code>package.json</code>.</p>
<p>Add &quot;mongodb&quot;: &quot;~1.4.19&quot; to the dependencies object inside the JSON so that it looks like this.</p>
<pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;codeweekend&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;0.0.0&quot;</span><span class="fu">,</span>
  <span class="dt">&quot;private&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
  <span class="dt">&quot;dependencies&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;body-parser&quot;</span><span class="fu">:</span> <span class="st">&quot;~1.6.6&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;cookie-parser&quot;</span><span class="fu">:</span> <span class="st">&quot;~1.3.3&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;cookie-session&quot;</span><span class="fu">:</span> <span class="st">&quot;~1.0.2&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;express&quot;</span><span class="fu">:</span> <span class="st">&quot;~4.8.6&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;hjs&quot;</span><span class="fu">:</span> <span class="st">&quot;~0.0.6&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;mongodb&quot;</span><span class="fu">:</span> <span class="st">&quot;~1.4.19&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;morgan&quot;</span><span class="fu">:</span> <span class="st">&quot;~1.2.3&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;nodemailer&quot;</span><span class="fu">:</span> <span class="st">&quot;^1.2.2&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;request&quot;</span><span class="fu">:</span> <span class="st">&quot;^2.42.0&quot;</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre>
<p>Now, let's actually import the database into the app. Any guesses on how to allow our app to use MongoDB's core functionality? Yup, we're first going to tell our app that we require it, which is done with the line:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="st">&quot;var mongo = require(&#39;mongodb&#39;);&quot;</span> </code></pre>
<p>Add it to our main file, app.js. Cool. Now let's make use of it. We're first going to have to create a database object and a server object and then create &amp; open a specific database so that we can use it later. See if you can understand the lines below.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> Db = <span class="ot">mongo</span>.<span class="fu">Db</span>;
<span class="kw">var</span> Server = <span class="ot">mongo</span>.<span class="fu">Server</span>;
<span class="kw">var</span> db = <span class="kw">new</span> <span class="fu">Db</span>(<span class="st">&#39;codeweekend&#39;</span>,
  <span class="kw">new</span> <span class="fu">Server</span>(<span class="st">&#39;localhost&#39;</span>, <span class="st">&#39;27017&#39;</span>, {<span class="dt">auto_reconnect</span>: <span class="kw">true</span>}, {}),
  {<span class="dt">safe</span>: <span class="kw">true</span>}
);
<span class="ot">db</span>.<span class="fu">open</span>(<span class="kw">function</span>(){});</code></pre>
<p>Hopefully, that was easy to follow. We've created a new database called 'codeweekend' that we can reach at port 27017. Inside of our middleware, we're also going to have to route any incoming database requests to our MongoDB, so let's add in this to the end of the function.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">req</span>.<span class="fu">db</span> = db;</code></pre>
<p>Now, let's really get our hands messy and jump into <code>routes.js</code>, where we'll change our existing code to make use of the powerful database we know have access to.</p>
<p>First things first:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> ObjectID = <span class="fu">require</span>(<span class="st">&#39;mongodb&#39;</span>).<span class="fu">ObjectID</span>;</code></pre>
<p>Let's get our database Object ID. Now, our existing code looks a little something like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">router</span>.<span class="fu">get</span>(<span class="st">&#39;/&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">render</span>(<span class="st">&#39;index&#39;</span>, {
    <span class="dt">title</span>: <span class="st">&#39;Codeweekend Notes&#39;</span>,
    <span class="dt">notes</span>: <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">notes</span>
  });
});</code></pre>
<p>We already know that this stores our notes in a session. However, now, let's make use of our up and runnig database instead. With a little change in how we access and store the notes object, we can now route the entire process through our DB, to change the routes.js file to:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> ObjectID = <span class="fu">require</span>(<span class="st">&#39;mongodb&#39;</span>).<span class="fu">ObjectID</span>;

<span class="ot">router</span>.<span class="fu">get</span>(<span class="st">&#39;/&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="ot">req</span>.<span class="ot">db</span>.<span class="fu">collection</span>(<span class="st">&#39;notes&#39;</span>).<span class="fu">find</span>().<span class="fu">toArray</span>(<span class="kw">function</span>(err, notes) {
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">render</span>(<span class="st">&#39;index&#39;</span>, {
      <span class="dt">title</span>: <span class="st">&#39;Codeweekend Notes&#39;</span>,
      <span class="dt">notes</span>: notes
    });
  });
});

<span class="ot">router</span>.<span class="fu">get</span>(<span class="st">&#39;/db&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="ot">req</span>.<span class="ot">db</span>.<span class="fu">collection</span>(<span class="st">&#39;test&#39;</span>).<span class="fu">find</span>().<span class="fu">toArray</span>(<span class="kw">function</span>(err, items) {
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">send</span>(items);
  });
});

<span class="ot">router</span>.<span class="fu">get</span>(<span class="st">&#39;/:id&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="ot">req</span>.<span class="ot">db</span>.<span class="fu">collection</span>(<span class="st">&#39;notes&#39;</span>).<span class="fu">findOne</span>({<span class="dt">_id</span>: <span class="fu">ObjectID</span>(<span class="ot">req</span>.<span class="ot">params</span>.<span class="fu">id</span>)}, <span class="kw">function</span>(err, note) {
    <span class="kw">if</span> (err || !note) {
      <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;That note does not exist!&#39;</span>;
      <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);
    }

    <span class="co">//return.res.sender</span>
  });
});

<span class="ot">router</span>.<span class="fu">post</span>(<span class="st">&#39;/create&#39;</span>, <span class="kw">function</span>(req, res) {
  <span class="kw">if</span> (!(<span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">title</span> &amp;&amp; <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">body</span>)) {
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;You must provide a title and a body!&#39;</span>;
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);
  }

  <span class="ot">req</span>.<span class="ot">db</span>.<span class="fu">collection</span>(<span class="st">&#39;notes&#39;</span>).<span class="fu">insert</span>({
    <span class="dt">title</span>: <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">title</span>,
    <span class="dt">body</span>: <span class="ot">req</span>.<span class="ot">body</span>.<span class="fu">body</span>
  }, <span class="kw">function</span>(err, result) {
    <span class="ot">req</span>.<span class="ot">session</span>.<span class="fu">message</span> = <span class="st">&#39;Note created!&#39;</span>;
    <span class="kw">return</span> <span class="ot">res</span>.<span class="fu">redirect</span>(<span class="st">&#39;/&#39;</span>);
  });
});

<span class="ot">module</span>.<span class="fu">exports</span> = router;</code></pre>
<p>Well that wasn't so bad. Every call to the database involves referencing our middleware <code>req.db</code> and using the collection (aka database) called 'notes'. We then use different functions like <code>findOne</code>, that finds one result, or <code>find().toArray</code> that gives us an array of all results in the databse. These functions also have callbacks that specify what to do in case there's an error, and if not, what to actually do with the result(s) we get. Who know switching storage stage could be that easy?</p>
<h4 id="youre-done">You're done!</h4>
<p>With that you've succesfully integrated your first database into a Node application and it's up and running. Congratulations, you now have a fully functioning NodeJS app hooked up to MongoDB.</p>
<p>Please do give members of the Code Weekend Team feedback on how to improve these workshops in the future and tell your friends what you've learned!</p>
<h4 id="files-3">Files</h4>
<p><a href="assets/files/ws4.zip">These files</a> should give you the end product that you should have at the end of this workshop, and really, Code Weekend as a whole!</p>
<div class="footer">
<p>
Â© Dining Philosophers 2015. Page created by <a href="http://pvrnav.com">Pranav Vishnu Ramabhadran</a>. Workshops designed by <a href="http://github.com/bclay/">Brynn Claypoole</a>, <a href="http://lewisjellis.com/">Lewis Ellis</a> and <a href="http://pvrnav.com">Pranav Vishnu Ramabhadran</a>.
</div>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="assets/js/nav.js"></script>
<script src="assets/js/FlowType.js"></script>
<script type="text/javascript">
    $('.markdown-body').flowtype({
        minimum   : 500,
        maximum   : 1000,
        minFont   : 16,
        maxFont   : 65,
        fontRatio : 40
    });
</script>
